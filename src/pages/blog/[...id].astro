---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';

export async function getStaticPaths() {
  const posts = await getCollection('blog', ({ data }) => {
    return import.meta.env.PROD ? !data.draft : true;
  });
  return posts.map((post) => ({
    params: { id: post.id },
    props: { post },
  }));
}

const { post } = Astro.props;
const { Content } = await post.render();
---

<BaseLayout title={post.data.title} description={post.data.description}>
  <article class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-20">
    <header class="mb-12">
      <a href="/blog" class="text-primary-600 hover:underline mb-4 inline-block">
        ← Back to Blog
      </a>
      <h1 class="font-heading font-bold text-4xl sm:text-5xl text-gray-900 mb-4">
        {post.data.title}
      </h1>
      <div class="text-gray-500 mb-4">
        {post.data.pubDate.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}
      </div>
      <div class="flex flex-wrap gap-2">
        {post.data.tags.map((tag: string) => (
          <span class="px-3 py-1 bg-primary-100 text-primary-700 rounded-full text-sm">
            {tag}
          </span>
        ))}
      </div>
    </header>
    
    <div class="prose prose-lg max-w-none prose-headings:font-heading prose-a:text-primary-600 prose-a:no-underline hover:prose-a:underline">
      <Content />
    </div>
    
    <footer class="mt-16 pt-8 border-t border-gray-200">
      <a href="/blog" class="text-primary-600 hover:underline">
        ← Back to all posts
      </a>
    </footer>
  </article>
</BaseLayout>
